---
layout: default
title: PySonar2 与 Sourcegraph 集成完毕
---

经过两个星期的勤奋工作，PySonar2 今天正式与 <a href="http://www.sourcegraph.com">Sourcegraph</a> 集成完毕。现在只要登录 Sourcegraph 主网站，就可以看到开源 Python 代码的 PySonar2 分析结果。

PySonar2 的类型推导系统能够不依赖类型标记却精确地分析出 Python 函数的参数类型。比如下图所示的 Flask 框架的最常用的五个函数的参数，都是通常的方法很难确定类型的，PySonar2 却能得知它们正确的用法。

<img src="http://www.yinwang.org/resources/pysonar2-sg-flask.png"  width="80%">

最有意思的是那个 `render_template`。PySonar2 给它推导出来的类型是：

	templating.render_template(template_name_or_list, **context)
	str -> ?
	| [str] -> ?

这是说第一个参数 `template_name_or_list` 的类型或者是 str 或者是 [str] （含有str 的 list）。如果你注意一下这个参数的含义，就会觉得仿佛 PySonar2 能读懂英语一样。


### Sourcegraph 的一些使用诀窍

Sourcegraph 有一些不为人知的良好设计，但是由于 Quinn 和 Beyang 太忙了，所以都没来的及宣传。我现在在这里透露两招小窍门。


#### 分析你需要的代码库

如果你想要在 Sourcegraph 浏览自己的 GitHub repo 代码，或者如果在主网站上面没有找到你需要的代码，这不等于你需要等我们来启动对它的分析。你可以自己动手！

方法很简单：把你的 GitHub 地址去掉 http://之后连接到 `http://sourcegraph.com/` 后面，然后 Sourcegraph 就会显示一个等待页面，同时自动开始为你分析这个 repo，一般几分钟到半个小时之内就会处理完毕。目前支持的语言是 Go, JavaScript, Python, Ruby。

举个例子，如果你想分析 http://github.com/xyz/abc 的代码。你就在浏览器输入地址：

	http://sourcegraph.com/github.com/xyz/abc

如果 Sourcegraph 还没有分析过这个 repo，它就会把它加入到工作队列里。然后你可以做其他的事情或者浏览其他的代码。分析完毕之后浏览器就会自动跳转到你所需要的代码库。


#### 在你的 GitHub README 里面使用 Sourcegraph 徽章

你也许发现有些人在自己的 GitHub 里有 Sourcegraph 徽章，这样一来别人就能得知你的代码库的一些统计信息。比如我的 psydiff 的 README 里面有这样一个：

<a href="http://github.com/yinwang0/psydiff"><img src="http://www.yinwang.org/resources/psydiff-badge.png" width="80%"></a>

它表示 psydiff 的代码被看过的次数。你也可以使用其他的一些徽章，比如最常用的函数，交叉引用数，等等：

<a href="https://sourcegraph.com/github.com/yinwang0/psydiff/badges"><img src="http://www.yinwang.org/resources/sg-badges.png"  width="80%"></a>

要得到这些徽章很简单，只要在你的 repo 的 Sourcegraph 主页里点击如图所示的扳手状小图标，然后把 "Image URL" 拷贝到你的网页里就行：

<a href="https://sourcegraph.com/github.com/yinwang0/psydiff/badges"><img src="http://www.yinwang.org/resources/sg-settings.png"></a>

<a href="https://sourcegraph.com/github.com/yinwang0/psydiff/badges"><img src="http://www.yinwang.org/resources/badge-image-url.png"></a>
